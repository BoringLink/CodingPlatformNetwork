# 需求文档

## 简介

本系统旨在构建一个教育知识图谱神经网络，通过分析教育项目中的多维度数据（包括学生互动、师生交流、课程记录、错误记录等），利用大语言模型进行智能判断和分析，生成结构化的知识图谱节点和关系，以支持个性化学习分析和教学优化。

## 术语表

- **系统 (System)**: 教育知识图谱神经网络系统
- **学生节点 (Student Node)**: 代表学生个体的图谱节点
- **教师节点 (Teacher Node)**: 代表教师个体的图谱节点
- **知识点节点 (Knowledge Point Node)**: 代表特定知识点的图谱节点
- **课程节点 (Course Node)**: 代表课程内容的图谱节点
- **错误类型节点 (Error Type Node)**: 代表学生错误类型的图谱节点
- **互动记录 (Interaction Record)**: 学生之间或师生之间的聊天、点赞等交互数据
- **课程记录 (Course Record)**: 学生参与课程的学习数据
- **错误记录 (Error Record)**: 学生在学习过程中产生的错误数据
- **大语言模型 (LLM)**: 用于分析和判断记录的人工智能模型
- **图谱关系 (Graph Relationship)**: 节点之间的连接关系，包含类型和权重
- **数据源 (Data Source)**: 现有教育项目的原始数据

## 需求

### 需求 1

**用户故事:** 作为系统管理员，我希望能够从现有教育数据中提取和定义不同类型的节点，以便构建完整的知识图谱结构。

#### 验收标准

1. WHEN 系统接收到原始教育数据 THEN 系统 SHALL 识别并创建学生节点、教师节点、知识点节点、课程节点和错误类型节点
2. WHEN 创建节点时 THEN 系统 SHALL 为每个节点分配唯一标识符和节点类型标签
3. WHEN 节点被创建 THEN 系统 SHALL 存储节点的基本属性信息（如学生ID、姓名、课程名称、知识点描述等）
4. WHEN 处理重复数据 THEN 系统 SHALL 检测并合并相同实体的节点，避免重复创建
5. WHEN 节点数据不完整 THEN 系统 SHALL 标记缺失字段并记录数据质量问题

### 需求 2

**用户故事:** 作为数据分析师，我希望系统能够识别和建立节点之间的关系，以便分析学生学习路径和知识关联。

#### 验收标准

1. WHEN 系统分析学生互动数据 THEN 系统 SHALL 创建学生节点之间的"聊天互动"和"点赞互动"关系
2. WHEN 系统分析师生互动数据 THEN 系统 SHALL 创建教师节点与学生节点之间的"教学互动"关系
3. WHEN 系统处理课程记录 THEN 系统 SHALL 创建学生节点与课程节点之间的"学习"关系，并记录学习时间和进度
4. WHEN 系统处理课程与知识点关联 THEN 系统 SHALL 创建课程节点与一个或多个知识点节点之间的"包含"关系
5. WHEN 系统处理错误记录 THEN 系统 SHALL 创建学生节点与错误类型节点之间的"产生错误"关系，并关联到相关知识点节点

### 需求 3

**用户故事:** 作为系统架构师，我希望集成大语言模型来智能分析记录内容，以便自动生成高质量的图谱节点和关系。

#### 验收标准

1. WHEN 系统接收到互动记录文本 THEN 系统 SHALL 调用大语言模型分析互动内容的语义和情感
2. WHEN 大语言模型分析错误记录 THEN 系统 SHALL 识别错误类型并推断相关的知识点
3. WHEN 大语言模型处理课程内容 THEN 系统 SHALL 提取关键知识点并建立知识点之间的依赖关系
4. WHEN 大语言模型分析完成 THEN 系统 SHALL 将分析结果转换为结构化的节点属性和关系数据
5. WHEN 大语言模型返回不确定结果 THEN 系统 SHALL 标记置信度分数并支持人工审核

### 需求 4

**用户故事:** 作为教育研究者，我希望系统能够处理学生的多课程多错误场景，以便全面了解学生的学习困难模式。

#### 验收标准

1. WHEN 一个学生在多个课程中产生错误 THEN 系统 SHALL 为每个错误创建独立的"产生错误"关系，连接到对应的课程节点和错误类型节点
2. WHEN 一个错误类型关联多个知识点 THEN 系统 SHALL 创建错误类型节点到所有相关知识点节点的"涉及"关系
3. WHEN 分析学生错误模式 THEN 系统 SHALL 聚合同一学生的所有错误关系，生成错误分布统计
4. WHEN 识别跨课程的知识点关联 THEN 系统 SHALL 建立不同课程节点通过共同知识点的间接关系
5. WHEN 学生在同一知识点上重复出错 THEN 系统 SHALL 增加该错误关系的权重值

### 需求 5

**用户故事:** 作为系统开发者，我希望系统能够持久化存储图谱数据，以便支持查询、更新和可视化操作。

#### 验收标准

1. WHEN 节点和关系被创建 THEN 系统 SHALL 将数据持久化到图数据库中
2. WHEN 系统接收到查询请求 THEN 系统 SHALL 支持基于节点类型、属性和关系的图查询
3. WHEN 原始数据更新 THEN 系统 SHALL 支持增量更新图谱，添加新节点和关系或修改现有数据
4. WHEN 数据冲突发生 THEN 系统 SHALL 应用冲突解决策略（如时间戳优先或保留最新数据）
5. WHEN 执行批量操作 THEN 系统 SHALL 使用事务机制确保数据一致性

### 需求 6

**用户故事:** 作为教师，我希望能够查询和可视化知识图谱，以便了解学生的学习状态和知识掌握情况。

#### 验收标准

1. WHEN 教师查询特定学生 THEN 系统 SHALL 返回该学生的所有关联节点和关系（课程、错误、互动等）
2. WHEN 教师查询特定知识点 THEN 系统 SHALL 返回掌握该知识点的学生列表和相关错误统计
3. WHEN 教师请求可视化 THEN 系统 SHALL 生成图谱的可视化表示，展示节点和关系
4. WHEN 查询结果过大 THEN 系统 SHALL 支持分页和过滤，限制返回的节点和关系数量
5. WHEN 生成可视化 THEN 系统 SHALL 使用不同颜色和形状区分不同类型的节点和关系

### 需求 7

**用户故事:** 作为数据工程师，我希望系统能够处理大规模数据，以便支持包含数千名学生和数万条记录的教育项目。

#### 验收标准

1. WHEN 系统处理大批量数据 THEN 系统 SHALL 使用批处理机制，每批处理不超过1000条记录
2. WHEN 调用大语言模型 THEN 系统 SHALL 实现请求队列和速率限制，避免API超限
3. WHEN 数据导入进行中 THEN 系统 SHALL 提供进度反馈，显示已处理和剩余的记录数量
4. WHEN 处理失败发生 THEN 系统 SHALL 记录错误日志并支持从断点续传
5. WHEN 系统负载过高 THEN 系统 SHALL 实现背压机制，暂停数据接收直到处理能力恢复

### 需求 8

**用户故事:** 作为系统维护者，我希望系统具有良好的错误处理和日志记录，以便快速定位和解决问题。

#### 验收标准

1. WHEN 大语言模型调用失败 THEN 系统 SHALL 记录错误详情并尝试重试，最多重试3次
2. WHEN 数据格式不符合预期 THEN 系统 SHALL 记录验证错误并跳过该条记录，继续处理后续数据
3. WHEN 图数据库连接失败 THEN 系统 SHALL 抛出明确的错误信息并停止数据写入操作
4. WHEN 系统运行时 THEN 系统 SHALL 记录关键操作日志，包括节点创建、关系建立和模型调用
5. WHEN 发生异常 THEN 系统 SHALL 提供详细的堆栈跟踪和上下文信息，便于调试

### 需求 9

**用户故事:** 作为系统开发者，我希望系统支持交互式可视化操作，以便用户能够深入探索图谱节点和构建自定义视图。

#### 验收标准

1. WHEN 用户悬停在节点上 THEN 系统 SHALL 显示节点的详细信息弹窗，包括节点类型、属性和关联关系数量
2. WHEN 用户点击节点 THEN 系统 SHALL 高亮显示该节点的所有直接关联节点和关系
3. WHEN 用户设置数据筛选条件 THEN 系统 SHALL 根据时间范围、节点类型、关系类型等条件过滤图谱数据
4. WHEN 用户创建子视图 THEN 系统 SHALL 基于筛选条件生成独立的子图谱视图，仅包含符合条件的节点和关系
5. WHEN 用户在子视图中操作 THEN 系统 SHALL 保持子视图的筛选状态，支持在子视图内进一步探索和分析

### 需求 10

**用户故事:** 作为产品经理，我希望系统能够生成分析报告，以便向教育机构展示学生学习洞察和知识图谱价值。

#### 验收标准

1. WHEN 请求生成报告 THEN 系统 SHALL 统计图谱中的节点总数和各类型节点的数量分布
2. WHEN 分析学生表现 THEN 系统 SHALL 识别高频错误知识点和需要重点关注的学生群体
3. WHEN 分析课程效果 THEN 系统 SHALL 计算每个课程的学生参与度和错误率
4. WHEN 分析互动模式 THEN 系统 SHALL 识别活跃的学生社交网络和孤立的学生节点
5. WHEN 生成报告 THEN 系统 SHALL 输出结构化的JSON或PDF格式报告，包含图表和统计数据
