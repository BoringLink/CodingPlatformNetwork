## 实现计划

### 1. 问题分析
- 前端已经有处理边权重的逻辑，但当前实现使用了最大宽度限制（8px），导致权重10和权重5的边宽度相同，不符合要求的比例关系
- 原计划的基础宽度1px太细，容易导致边缘不可见
- 后端已经从Neo4j数据库中提取权重数据，并在关系模型中包含了weight字段
- 前端类型定义中已经包含了weight字段

### 2. 实现步骤

#### 2.1 重新设计权重与宽度的映射规则
- **核心要求**: 权重10的关系连线粗细必须是权重5的2倍
- **可见性优先**: 确保所有边都清晰可见，避免过细
- **新映射规则**: 
  - 基础宽度: 2px（确保所有边都可见）
  - 比例因子: 0.6px/权重单位
  - 计算公式: `Math.max((ele.data("weight") || 1) * 0.6, 2)`
  - 预期效果: 
    - 权重0 → 2px
    - 权重5 → 3px (5 * 0.6 = 3)
    - 权重10 → 6px (10 * 0.6 = 6) → 是权重5的2倍，符合要求
    - 权重15 → 9px
    - 权重20 → 12px

#### 2.2 修改前端边样式计算逻辑
- **文件**: `/Users/tk/Documents/CodingPlatformNetwork/frontend/components/graph-visualization.tsx`
- **修改点**: 第177-178行的边宽度计算逻辑
- **当前实现**: `Math.min(Math.max((ele.data("weight") || 1) * 2, 1), 8)`
- **新实现**: 去除最大限制，使用新的映射规则
  ```javascript
  Math.max((ele.data("weight") || 1) * 0.6, 2)
  ```

#### 2.3 验证后端权重数据传递
- 检查后端`_convert_relationship`方法是否正确提取权重数据
- 确认关系对象在序列化过程中包含weight字段
- 如有必要，修改后端代码确保权重数据正确传递

#### 2.4 测试不同权重值的显示效果
- 确保权重10的边宽度是权重5的边宽度的2倍
- 验证视觉效果合理，所有边都清晰可见
- 测试边界情况（权重0、负数、非常大的值）

### 3. 技术细节

#### 3.1 映射规则说明
- 采用线性映射，确保权重与宽度成正比
- 设置最小宽度2px，确保所有边都可见
- 比例因子0.6px/权重，确保权重10是权重5的2倍
- 无最大宽度限制，允许极端权重值有明显的视觉差异

#### 3.2 测试用例
- 权重0 → 2px（最小宽度）
- 权重5 → 3px
- 权重10 → 6px（是权重5的2倍，符合要求）
- 权重15 → 9px
- 权重20 → 12px

### 4. 实现验证
- 启动前后端服务
- 查看不同权重关系的连线粗细
- 验证比例关系是否正确
- 确认所有边都清晰可见
- 确认不影响其他功能

### 5. 预期效果
- 关系权重可视化直观清晰
- 权重差异通过连线粗细明确体现
- 权重10的连线确实是权重5的2倍
- 所有边都清晰可见，不会过于纤细
- 视觉效果合理，不会影响整体图形美观

### 6. 代码修改点
- 仅需修改前端`graph-visualization.tsx`文件中的边样式计算逻辑
- 后端代码无需修改，已正确处理权重数据
- 类型定义无需修改，已包含weight字段